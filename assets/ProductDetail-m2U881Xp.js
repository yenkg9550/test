import{S as m}from"./sweetalert2.all-CxW6M65U.js";import{_ as S,L as D,m as N,I as W,g as b,h as j,c as l,a as s,b as L,w as T,j as g,x as E,k as w,F as v,i as p,t as r,A as P,f as y,r as F,o as d,e as U,p as V,d as G}from"./index-FDdSSu7m.js";import{u as k}from"./user-h2UowS-I.js";/* empty css              */import{W as C}from"./WineGlassLoader-x5xDUxi2.js";import"./helpers-Hx-ZzB2u.js";var A={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_REPO_NAME:"travel590",BASE_URL:"/test/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:f}=A,B={name:"ProductDetail",components:{Loading:D,WineGlassLoader:C},data(){return{title:"產品詳情",products:[],selectedProduct:{},similarWines:[],cart:[],favoriteList:[],allFavoriteList:[],userId:"",isLoading:!1,fullPage:!0}},methods:{...N(k,["setUser","cleanUser","getUserCookie"]),doLoading(){this.$loading.show({props:{spinner:C},container:this.$refs.loadingContainer,canCancel:!0,color:"#000000",loader:"spinner",width:64,height:64,backgroundColor:"#ffffff",opacity:.5,zIndex:999},{default:W("WineGlassLoader")}).hide()},setLoadingTime(){this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},800)},getProduct(){const e=`${f}/products`;b.get(e).then(a=>{this.setLoadingTime(),this.products=a.data,this.selectedProduct=this.products.find(c=>c.id===this.$route.params.id),this.findSimilarWinesByGrape(this.selectedProduct,this.products)}).catch(()=>{})},getCartList(){const e=`${f}/carts`;b.get(e).then(a=>{this.cart=a.data.filter(c=>c.userId===this.userId)}).catch(()=>{})},addToCart(e){if(!this.userId){alert("請先登入");return}const a=`${f}/carts`,c=this.cart.findIndex(n=>n.product_id===e.id&&n.userId===this.userId);if(c===-1){const n={product_id:e.id,chineseName:e.chineseName,image:e.image,price:e.price,is_hot:e.is_hot,star:e.star,qty:1,userId:this.userId};b.post(a,n).then(t=>{m.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{m.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}else{const n=this.cart[c].id;this.cart[c].qty+=1;const t={qty:this.cart[c].qty};b.patch(`${a}/${n}`,t).then(h=>{m.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{m.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}this.getCartList()},getFavoriteList(){const e=`${f}/favorite`;b.get(e).then(a=>{this.allFavoriteList=a.data,this.favoriteList=a.data.filter(c=>c.userId===this.userId),this.checkFavoriteStatus()}).catch(()=>{})},checkFavoriteStatus(){this.selectedProduct.isFavorite=this.favoriteList.some(e=>e.productId===this.selectedProduct.id)},addToFavorite(e){if(!this.userId){alert("請先登入");return}const a=`${f}/favorite`,c=new Date,n=`${c.getFullYear()}/${(c.getMonth()+1).toString().padStart(2,"0")}/${c.getDate().toString().padStart(2,"0")}`,t={userId:this.userId,productId:this.selectedProduct.id,created_at:n};b.post(a,t).then(h=>{this.getFavoriteList(),m.fire({title:"加入最愛",text:"商品已經成功加入最愛清單。",icon:"success"})}).catch(()=>{})},toggleFavorite(e){this.selectedProduct.isFavorite?this.removeFromFavorite(e.id):this.addToFavorite(e.id)},removeFromFavorite(e){if(!this.userId){alert("請先登入");return}const a=`${f}/favorite`,c=this.allFavoriteList.findIndex(t=>t.productId===e&&t.userId===this.userId),n=this.allFavoriteList[c].id;b.delete(`${a}/${n}`,{userId:this.userId,id:c}).then(t=>{this.getFavoriteList(),m.fire({title:"移出最愛",text:"商品已經成功移出最愛清單",icon:"success"})}).catch(()=>{})},findSimilarWinesByGrape(e,a,c=4){const n=e.grape,h=a.filter(_=>_.grape.some(i=>n.includes(i))).filter(_=>_.id!==e.id);h.sort((_,i)=>i.star-_.star);const I=h.slice(0,c);this.similarWines=I},seeProduct(e){this.$router.push({name:"ProductDetail",params:{id:e}}),this.getProduct()}},computed:{...j(k,["getUser"])},mounted(){const{userId:e}=this.getUserCookie();this.userId=e,this.getProduct(),this.getCartList(),this.getFavoriteList()}},o=e=>(V("data-v-850b3c1d"),e=e(),G(),e),R={class:"container"},q={class:"productDisplay pt-5 pb-5"},M={class:"row justify-content-between mb-4"},z={class:"col-12 col-md-4 product-image-block d-flex flex-column align-items-center justify-content-between"},O={class:"position-relative"},Q=["src","alt"],Y=y('<ul class="socialFriends d-flex" data-v-850b3c1d><li data-v-850b3c1d><a href="#" data-v-850b3c1d><i class="bi bi-facebook" data-v-850b3c1d></i></a></li><li data-v-850b3c1d><a href="#" data-v-850b3c1d><i class="bi bi-instagram" data-v-850b3c1d></i></a></li><li data-v-850b3c1d><a href="#" data-v-850b3c1d><i class="bi bi-line" data-v-850b3c1d></i></a></li></ul>',1),H={class:"col-12 col-md-6"},J={class:"card-body"},K={class:"d-flex justify-content-between mb-3"},X={key:0,class:"badge bg-danger fs-6"},Z={class:"text-warning d-flex gap-1 mb-1"},$={class:"card-title mb-2"},ss={class:"d-flex justify-content-between mb-3"},ts=o(()=>s("p",{class:"card-text"},"750ml",-1)),es={class:"card-text fs-4 text-danger fw-bold"},is={class:"pb-3"},as=o(()=>s("h5",{class:"pb-2"},"風味分類",-1)),cs={class:"row"},os=["src","alt"],ls=o(()=>s("h5",{class:"pb-2"},"餐酒搭配選擇",-1)),ds={class:"row"},rs=["src","alt"],ns={class:"row justify-content-between mb-4"},hs={class:"col-12 col-md-6 mt-4"},us=o(()=>s("h4",{class:"mb-4"},"葡萄酒品味",-1)),_s=o(()=>s("p",{class:"mb-1"},"單寧",-1)),bs={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},ms=o(()=>s("p",{class:"mb-1"},"酸度",-1)),vs={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},ps=o(()=>s("p",{class:"mb-1"},"甜度",-1)),fs={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},gs=o(()=>s("p",{class:"mb-1"},"酒體",-1)),xs={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},Ps={class:"col-12 col-md-5 mt-4"},ys=o(()=>s("h4",{class:"mb-4"},"產品介紹",-1)),Is={class:"table table-striped table-hover"},ws=o(()=>s("th",null,"酒種",-1)),Ls=o(()=>s("th",null,"產地",-1)),Fs=o(()=>s("th",null,"出產酒莊",-1)),ks=o(()=>s("th",null,"葡萄品種",-1)),Cs={key:0},Ss={class:"row"},Ds={class:"col"},Ns=o(()=>s("h4",{class:"mb-4"},"好評推推推",-1)),Ws={class:"row d-flex align-items-stretch gy-3"},js={class:"col-12 col-md-3"},Ts={class:"card h-100 pb-3"},Es={class:"card-body px-4"},Us=y('<div class="text-warning d-flex gap-1 mb-1" data-v-850b3c1d><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i></div>',1),Vs={class:"card-title mb-3"},Gs=o(()=>s("p",{class:"card-text"}," 卡師伯： 我是第一次在網上購買酒類，配晚餐挺搭，會再購買! ",-1)),As={class:"col-12 col-md-3"},Bs={class:"card h-100 pb-3"},Rs={class:"card-body px-4"},qs=y('<div class="text-warning d-flex gap-1 mb-1" data-v-850b3c1d><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i></div>',1),Ms={class:"card-title mb-3"},zs=o(()=>s("p",{class:"card-text"},"Steve: 經過醒酒後果香濃郁，比較一下價格實在物超所值！",-1)),Os={class:"col-12 col-md-3"},Qs={class:"card h-100 pb-3"},Ys={class:"card-body px-4"},Hs=o(()=>s("div",{class:"text-warning d-flex gap-1 mb-1"},[s("i",{class:"bi bi-star-fill fs-5"}),s("i",{class:"bi bi-star-fill fs-5"})],-1)),Js={class:"card-title mb-3"},Ks=o(()=>s("p",{class:"card-text"},"小明： 普普通通，不推薦.",-1)),Xs={class:"col-12 col-md-3"},Zs={class:"card h-100 pb-3"},$s={class:"card-body px-4"},st=y('<div class="text-warning d-flex gap-1 mb-1" data-v-850b3c1d><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i><i class="bi bi-star-fill fs-5" data-v-850b3c1d></i></div>',1),tt={class:"card-title mb-3"},et=o(()=>s("p",{class:"card-text"}," Lukka: 性價比不錯，但偏酸，不是很愛． 之前在這網站有買過其他推薦的紅酒都很不錯． ",-1)),it={class:"moreProduct py-5"},at={class:"container"},ct=o(()=>s("h3",{class:"text-white pb-5"},"您可能會喜歡的商品",-1)),ot={class:"row gy-3"},lt={class:"card d-flex flex-column h-100 product_card"},dt=["onClick"],rt=["src","alt"],nt={class:"card-body h-100 d-flex flex-column justify-content-between"},ht={class:"d-flex flex-column mb-3"},ut={class:"d-flex justify-content-between mb-1"},_t={key:0,class:"badge bg-danger"},bt={class:"text-warning d-flex gap-1 mb-1"},mt=["onClick"],vt={class:"card-title text-black"},pt={class:"card-text text-danger fw-bold"},ft=["onClick"];function gt(e,a,c,n,t,h){const I=F("WineGlassLoader"),_=F("loading");return d(),l("div",null,[s("div",R,[L(_,{active:t.isLoading,"onUpdate:active":a[0]||(a[0]=i=>t.isLoading=i),"is-full-page":t.fullPage},{default:T(()=>[L(I)]),_:1},8,["active","is-full-page"]),s("div",q,[s("div",M,[s("div",z,[s("div",O,[s("img",{src:e.$filters.imgPath(`/images/wine_images/${t.selectedProduct.image}.jpg`),class:"product-image",alt:t.selectedProduct.chineseName},null,8,Q),s("a",{href:"#",onClick:a[1]||(a[1]=g(i=>h.toggleFavorite(t.selectedProduct),["prevent"]))},[s("i",{class:E(["bi heart position-absolute top-5 start-10",{"bi-heart":!t.selectedProduct.isFavorite,"bi-heart-fill":t.selectedProduct.isFavorite}])},null,2)])]),Y]),s("div",H,[s("div",J,[s("div",K,[t.selectedProduct.is_hot?(d(),l("span",X,"熱賣推薦")):w("",!0),s("div",Z,[(d(!0),l(v,null,p(t.selectedProduct.star,i=>(d(),l("i",{class:"bi bi-star-fill text-warning",key:i}))),128))])]),s("h3",$,r(t.selectedProduct.chineseName),1),s("div",ss,[ts,s("p",es,"$ "+r(t.selectedProduct.price),1)]),s("div",is,[as,s("div",cs,[(d(!0),l(v,null,p(t.selectedProduct.flavor,(i,u)=>(d(),l("div",{class:"col-2 d-flex flex-column align-items-center",key:u},[s("img",{src:e.$filters.imgPath(`/images/fruit_images/${i}.jpg`),alt:i,class:"fruit-image rounded-circle mb-2"},null,8,os),s("p",null,r(i),1)]))),128))])]),s("div",null,[ls,s("div",ds,[(d(!0),l(v,null,p(t.selectedProduct.food,(i,u)=>(d(),l("div",{class:"col-4 col-md-2 d-flex flex-column align-items-center",key:u},[s("img",{src:e.$filters.imgPath(`/images/food_images/${i}.jpg`),alt:i,class:"food-image rounded-circle mb-2"},null,8,rs),s("p",null,r(i),1)]))),128))])]),s("a",{href:"#",class:"btn btn-primary w-100 py-2 mt-3",onClick:a[2]||(a[2]=g(i=>h.addToCart(t.selectedProduct),["prevent"]))},"加入購物車")])])]),s("div",ns,[s("div",hs,[us,_s,s("div",bs,[s("div",{class:"progress-bar progress-bar-striped",style:P({width:t.selectedProduct.taste?t.selectedProduct.taste.tannin:"0%"})},null,4)]),ms,s("div",vs,[s("div",{class:"progress-bar progress-bar-striped",style:P({width:t.selectedProduct.taste?t.selectedProduct.taste.acidity:"0%"})},null,4)]),ps,s("div",fs,[s("div",{class:"progress-bar progress-bar-striped",style:P({width:t.selectedProduct.taste?t.selectedProduct.taste.sweet:"0%"})},null,4)]),gs,s("div",xs,[s("div",{class:"progress-bar progress-bar-striped",style:P({width:t.selectedProduct.taste?t.selectedProduct.taste.body:"0%"})},null,4)])]),s("div",Ps,[ys,s("table",Is,[s("tbody",null,[s("tr",null,[ws,s("td",null,r(t.selectedProduct.wineStyle),1)]),s("tr",null,[Ls,s("td",null,r(t.selectedProduct.place),1)]),s("tr",null,[Fs,s("td",null,r(t.selectedProduct.village),1)]),s("tr",null,[ks,s("td",null,[(d(!0),l(v,null,p(t.selectedProduct.grape,(i,u)=>(d(),l("span",{key:u},[U(r(i)+" ",1),u<t.selectedProduct.grape.length-1?(d(),l("span",Cs,", ")):w("",!0)]))),128))])])])])])]),s("div",Ss,[s("div",Ds,[Ns,s("div",Ws,[s("div",js,[s("div",Ts,[s("div",Es,[Us,s("h5",Vs,r(t.selectedProduct.chineseName),1),Gs])])]),s("div",As,[s("div",Bs,[s("div",Rs,[qs,s("h5",Ms,r(t.selectedProduct.chineseName),1),zs])])]),s("div",Os,[s("div",Qs,[s("div",Ys,[Hs,s("h5",Js,r(t.selectedProduct.chineseName),1),Ks])])]),s("div",Xs,[s("div",Zs,[s("div",$s,[st,s("h5",tt,r(t.selectedProduct.chineseName),1),et])])])])])])])]),s("div",it,[s("div",at,[ct,s("div",ot,[(d(!0),l(v,null,p(t.similarWines,(i,u)=>(d(),l("div",{class:"col-6 col-md-3",key:u},[s("div",lt,[s("a",{href:"#",onClick:g(x=>h.seeProduct(i.id),["prevent"])},[s("img",{src:e.$filters.imgPath(`/images/wine_images/${i.image}.jpg`),class:"card-img-top",alt:i.chineseName},null,8,rt)],8,dt),s("div",nt,[s("div",ht,[s("div",ut,[i.is_hot?(d(),l("span",_t,"熱賣推薦")):w("",!0),s("div",bt,[(d(!0),l(v,null,p(i.star,x=>(d(),l("i",{class:"bi bi-star-fill text-warning",key:x}))),128))])]),s("a",{href:"#",onClick:g(x=>h.seeProduct(i.id),["prevent"])},[s("h5",vt,r(i.chineseName),1)],8,mt),s("p",pt,"$ "+r(i.price),1)]),s("a",{href:"#",class:"btn btn-primary w-100",onClick:g(x=>h.addToCart(i),["prevent"])},"加入購物車",8,ft)])])]))),128))])])])])}const Ft=S(B,[["render",gt],["__scopeId","data-v-850b3c1d"]]);export{Ft as default};
