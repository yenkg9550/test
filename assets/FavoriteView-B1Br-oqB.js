import{_,m,g as v,c as d,a as e,t as a,y as f,z as g,F as w,i as x,o as l,j as p,p as C,d as F}from"./index-1zPm9xHH.js";import{S as h}from"./sweetalert2.all-boEJ36Cu.js";import{u as b}from"./user--l8YfUSM.js";import{_ as S}from"./footerContainer-ZumBG5uF.js";import"./helpers-Hx-ZzB2u.js";const I={name:"FavoriteView",components:{},data(){return{title:"慾望酒單",userId:0,sortFilter:"1",list:[]}},mounted(){const{userToken:t,userId:s}=this.getUserCookie();t&&s?(this.userId=s,this.getFavoriteList()):this.$router.push("/login")},computed:{getSortList(){const t=JSON.parse(JSON.stringify(this.list));return this.sortFilter==="1"?t.sort((s,i)=>s.product.price-i.product.price):t.sort((s,i)=>i.product.price-s.product.price)}},methods:{...m(b,["getUserCookie","addToCart","resetUserFavorites"]),getFavoriteList(){if(!this.userId)return;const t=`https://vue3-course-api.hexschool.io/v2/favorite?userId=${this.userId}&_expand=product`;this.$http.get(t).then(s=>{this.list=s.data}).catch(s=>{console.log(s.response)})},removeFavorite(t){!this.userId||!(t!=null&&t.id)||h.fire({title:"確認移除收藏嗎?",text:`商品: ${t.product.chineseName}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"確定",cancelButtonText:"取消"}).then(s=>{s.isConfirmed&&v.delete(`https://vue3-course-api.hexschool.io/v2/favorite/${t.id}`).then(i=>{this.getFavoriteList(),this.resetUserFavorites(),h.fire({title:"刪除成功",text:"",icon:"success"})}).catch(i=>{console.log(i.response),h.fire({title:"收藏失敗",text:"",icon:"error"})})})},addToUserCart(t){console.log("addToUserCart",t),this.addToCart(t)}}},r=t=>(C("data-v-aa4ae316"),t=t(),F(),t),k={class:"container mb-5"},y={class:"row"},$={class:"d-flex justify-content-between align-items-end mt-3"},T={class:"mt-5 mb-1 fs-3 font-weight-normal fw-bold"},B=r(()=>e("option",{value:"1"},"依價格排序 ⬆",-1)),U=r(()=>e("option",{value:"2"},"依價格排序 ⬇",-1)),L=[B,U],N=r(()=>e("img",{src:S,class:"w-100 my-5"},null,-1)),j={class:"card"},V=["src"],D={class:"card-body"},J={class:"card-title text-wrap"},M={class:"card-text"},O={class:"d-flex justify-content-between align-items-end"},z={class:"card-text m-0"},A=["onClick"],E=r(()=>e("i",{class:"bi bi-trash"},null,-1)),P=[E],q=["onClick"],G=r(()=>e("i",{class:"bi bi-cart3"},null,-1)),H=[G];function K(t,s,i,Q,c,n){return l(),d("div",k,[e("div",y,[e("div",$,[e("h2",T,"會員 / "+a(c.title),1),f(e("select",{class:"filter-sort","onUpdate:modelValue":s[0]||(s[0]=o=>c.sortFilter=o)},L,512),[[g,c.sortFilter]])]),N,(l(!0),d(w,null,x(n.getSortList,o=>(l(),d("div",{class:"col-md-3 mt-3",key:o.id},[e("div",j,[e("img",{class:"card-img-top",src:t.$filters.imgPath(`/images/wine_images/${o.product.image}.jpg`),alt:"Card image cap"},null,8,V),e("div",D,[e("div",null,[e("h5",J,a(o.product.chineseName),1),e("p",M,a(o.product.wineStyle),1)]),e("div",O,[e("p",z,"NT$ "+a(o.product.price),1),e("div",null,[e("a",{href:"#",class:"btn btn-danger mx-3",onClick:p(u=>n.removeFavorite(o),["prevent"])},P,8,A),e("a",{href:"#",class:"btn btn-warning",onClick:p(u=>n.addToUserCart(o.product),["prevent"])},H,8,q)])])])])]))),128))])])}const tt=_(I,[["render",K],["__scopeId","data-v-aa4ae316"]]);export{tt as default};
